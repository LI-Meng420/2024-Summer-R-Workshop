# H0: 50% Good
.5*.5*.5*.5*.5
diamonds
lm(price ~ carat + depth + table, data = diamonds) %>%
summary()
ols <- lm(price ~ carat + depth + table, data = diamonds)
tidy(ols)
pacman::p_load(
tidyverse, statart,
broom, broom.mixed
)
tidy(ols)
nrow(diamonds)
pacman::p_load(
tidyverse, statart,
broom, broom.mixed,
MCMCpack
)
pacman::p_load(
tidyverse, statart,
broom, broom.mixed,
MCMCpack, rstan, rstanarm
)
# MCMC: Markov Chain Monte Carlo
# Numerical methods (扔飞镖，一个个尝试)
# 1e-4 = 0.0001, 1e4 = 10000
beyes0 <- MCMCregress(
price ~ carat + depth + table, data = diamonds,
b0 = 0, # Prior mean
B0 = 1e-4 # Prior precision (inverse of variance)
)
summary(bayes0)
summary(bayes0)
tidy(bayes0)
# MCMC: Markov Chain Monte Carlo
# Numerical methods (扔飞镖，一个个尝试)
# 1e-4 = 0.0001, 1e4 = 10000
beyes0 <- MCMCregress(
price ~ carat + depth + table, data = diamonds,
b0 = 0, # Prior mean
B0 = 1e-4 # Prior precision (inverse of variance)
)
summary(bayes0)
# MCMC: Markov Chain Monte Carlo
# Numerical methods (扔飞镖，一个个尝试)
# 1e-4 = 0.0001, 1e4 = 10000
bayes0 <- MCMCregress(
price ~ carat + depth + table, data = diamonds,
b0 = 0, # Prior mean
B0 = 1e-4 # Prior precision (inverse of variance)
)
summary(bayes0)
tidy(bayes0)
tidy(ols) %>%
full_join(
tidy(bayes0),
by = "term",
suffix = c("_ols", "_bayes")
)
tidy(ols) %>%
full_join(
tidy(bayes0),
by = "term",
suffix = c("_ols", "_bayes")
)
tidy(ols) %>%
full_join(
tidy(bayes0),
by = "term",
suffix = c("_ols", "_bayes")
) %>%
select(term, estimate_ols, estimate_bayes)
select <- tidyverse::select
select <- dplyr::select
tidy(ols) %>%
full_join(
tidy(bayes0),
by = "term",
suffix = c("_ols", "_bayes")
) %>%
select(term, estimate_ols, estimate_bayes)
# MCMC: Markov Chain Monte Carlo
# Numerical methods (扔飞镖，一个个尝试)
# 1e-4 = 0.0001, 1e4 = 10000
bayes0 <- MCMCregress(
price ~ carat + depth + table, data = diamonds,
b0 = 0, # Prior mean
B0 = 1e-8 # Prior precision (inverse of variance)
)
tidy(ols) %>%
full_join(
tidy(bayes0),
by = "term",
suffix = c("_ols", "_bayes")
) %>%
select(term, estimate_ols, estimate_bayes)
tidy(bayes0) %>%
full_join(
tidy(bayes1),
by = "term",
suffix = c("_bayes0", "_bayes1")
) %>%
select(term, estimate_ols, estimate_bayes)
bayes1 <- MCMCregress(
price ~ carat + depth + table, data = diamonds,
b0 = 100, # Prior mean
B0 = 1e-8 # Prior precision (inverse of variance)
)
tidy(bayes0) %>%
full_join(
tidy(bayes1),
by = "term",
suffix = c("_bayes0", "_bayes1")
) %>%
select(term, s_match("estimate*"))
tidy(bayes0) %>%
full_join(
tidy(bayes2),
by = "term",
suffix = c("_bayes0", "_bayes2")
) %>%
select(term, s_match("estimate*"))
bayes2 <- MCMCregress(
price ~ carat + depth + table, data = diamonds,
b0 = 0, # Prior mean
B0 = 1 # Prior precision (inverse of variance)
)
tidy(bayes0) %>%
full_join(
tidy(bayes2),
by = "term",
suffix = c("_bayes0", "_bayes2")
) %>%
select(term, s_match("estimate*"))
as_tibble(bayes0)
tidy(ols) %>%
full_join(
tidy(bayes0),
by = "term",
suffix = c("_ols", "_bayes")
) %>%
select(term, estimate_ols, estimate_bayes)
# Bayesian approach
qbeta(.025, 6, 5) # 0.25
# Bayesian approach
pbeta(1, 1, 1)
# Bayesian approach
pbeta(.5, 1, 1)
# Bayesian approach
pbeta(.1, 1, 1)
?pbeta
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
geom_vline(xintercept = .1, col = "red") +
labs(title = "Beta(1, 1) Prior",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 0, 0)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
# Bayesian approach
pbeta(0, 0, 0)
# Bayesian approach
pbeta(1, 0, 0)
# Bayesian approach
pbeta(2, 0, 0)
# Bayesian approach
pbeta(3, 0, 0)
tibble(
x = seq(0, 10, by = .01),
y = pbeta(x, 0, 0)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 10, by = .01),
y = pbeta(x, 1, 0)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 10, by = .01),
y = pbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 0, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 0, 2)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 1, 0)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = pbeta(x, 2, 2)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density")
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line() +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot(aes(x, y)) +
geom_line(
lwd = 1
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
?geom_area
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot() +
?geom_area(
aes(x, ymin = 0, ymax = y),
lwd = 1
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot() +
geom_area(
aes(x, ymin = 0, ymax = y),
lwd = 1
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
lwd = 1
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot() +
geom_ribbon(
aes(xmin = 0, xmax = 1, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, 1, 1)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = "Beta(1, 1)",
x = "Good Rate",
y = "Density") +
theme_bw()
# Bayesian approach
beta_plot <- function(alpha, beta) {
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, alpha, beta)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
coord_cartesian(
xlim = c(0, 1),
ylim = c(0, 1)
) +
labs(title = str_glue("Beta({alpha}, {beta})"),
x = "Good Rate",
y = "Density") +
theme_bw()
}
beta_plot(1, 1)
beta_plot(6, 1)
# Bayesian approach
beta_plot <- function(alpha, beta) {
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, alpha, beta)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
coord_cartesian(
xlim = c(0, 1)
) +
labs(title = str_glue("Beta({alpha}, {beta})"),
x = "Good Rate",
y = "Density") +
theme_bw()
}
beta_plot(1, 1)
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, alpha, beta)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
scale_x_continuous(
breaks = seq(0, 1, by = .2)
) +
coord_cartesian(
xlim = c(0, 1)
) +
labs(title = str_glue("Beta({alpha}, {beta})"),
x = "Good Rate",
y = "Density") +
theme_bw()
# Bayesian approach
beta_plot <- function(alpha, beta) {
tibble(
x = seq(0, 1, by = .01),
y = dbeta(x, alpha, beta)
) %>%
ggplot() +
geom_ribbon(
aes(x, ymin = 0, ymax = y),
color = "black", lwd = 1,
fill = "lightgrey"
) +
scale_x_continuous(
breaks = seq(0, 1, by = .2)
) +
coord_cartesian(
xlim = c(0, 1)
) +
labs(title = str_glue("Beta({alpha}, {beta})"),
x = "Good Rate",
y = "Density") +
theme_bw()
}
beta_plot(1, 1)
beta_plot(6, 1)
beta_plot(91, 11)
beta_plot(96, 11)
beta_plot(901, 101)
beta_plot(9001, 1001)
# All 10,000 trials
as_tibble(bayes0)
